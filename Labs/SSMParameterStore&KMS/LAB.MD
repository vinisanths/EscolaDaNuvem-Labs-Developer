# Laborat√≥rio: Gerenciamento Seguro de Par√¢metros com AWS SSM Parameter Store e KMS (CLI)

Este reposit√≥rio cont√©m os passos e comandos essenciais de um laborat√≥rio pr√°tico focado na utiliza√ß√£o do **AWS Systems Manager Parameter Store** e do **AWS Key Management Service (KMS)** para armazenar e gerenciar configura√ß√µes e segredos de aplica√ß√µes na AWS de forma segura, acessando-os via **AWS CLI** no **CloudShell**.

## üöÄ O que aprendemos neste Lab?

Neste hands-on, exploramos como um desenvolvedor pode armazenar e acessar configura√ß√µes de aplica√ß√µes, como URLs de banco de dados e senhas, de maneira segura. O foco foi na utiliza√ß√£o do Parameter Store para centralizar essas informa√ß√µes e do KMS para criptografar dados sens√≠veis. 

### Objetivos Alcan√ßados:

* Cria√ß√£o de par√¢metros do tipo `String` e `SecureString` no Parameter Store. 
* Cria√ß√£o e gerenciamento de uma chave de criptografia personalizada no KMS. 
* Recupera√ß√£o de par√¢metros utilizando a AWS CLI, tanto em formato criptografado quanto descriptografado. 
* Navega√ß√£o e intera√ß√£o com os principais recursos do AWS Systems Manager e CloudShell. 

## üõ†Ô∏è Pr√©-requisitos

Para replicar este laborat√≥rio, voc√™ precisar√°:

* Uma Conta AWS ativa. 
* Acesso ao Console de Gerenciamento da AWS. 
* Permiss√µes configuradas para usar os servi√ßos Systems Manager (SSM), KMS e CloudShell. 

## Parte 1: Cria√ß√£o de Par√¢metros no SSM Parameter Store

Vamos criar quatro par√¢metros essenciais para nosso aplicativo: duas URLs de banco de dados (desenvolvimento e produ√ß√£o) e duas senhas (tamb√©m para desenvolvimento e produ√ß√£o).

### Cria√ß√£o de Par√¢metros do Tipo `String` (URLs)

1.  Acesse o [Console de Gerenciamento da AWS](https://aws.amazon.com/console/) e navegue at√© o servi√ßo **AWS Systems Manager (SSM)**. 
2.  No painel de navega√ß√£o esquerdo, clique em `Application Tools` > `Parameter Store`. 
3.  Clique em `Create parameter`. 

    * **Par√¢metro 1 - Ambiente de Desenvolvimento (URL)**:
        * `Name`: `/meu-app-SeuNomeSobreNome/dev/db-url` 
        * `Description`: `Database URL for my app in dev` 
        * `Type`: `String` 
        * `Value`: `dev.database.SeuNomeSobrenome.com:3306` 
        * Clique em `Create parameter`. 

    * **Par√¢metro 2 - Ambiente de Produ√ß√£o (URL)**:
        * Repita os passos, clicando novamente em `Create parameter`. 
        * `Name`: `/meu-app-SeuNomeSobreNome/prod/db-url` 
        * `Description`: `Database URL for my app in prod` 
        * `Type`: `String` 
        * `Value`: `prod.database.SeuNomeSobrenome.com:3306` 
        * Clique em `Create parameter`. 

    > üìù **Dica**: Anote os nomes completos dos par√¢metros criados, voc√™ precisar√° deles mais tarde! 

## Parte 2: Cria√ß√£o da Chave KMS (AWS Key Management Service)

Para garantir a seguran√ßa de nossas senhas, utilizaremos o KMS para criptograf√°-las.

1.  Acesse o [Console de Gerenciamento da AWS](https://aws.amazon.com/console/) e navegue at√© o servi√ßo **AWS Key Management Service (KMS)**. 
2.  Clique em `Create a key`. 
3.  Na primeira tela, mantenha as op√ß√µes padr√£o e clique em `Next`. 
4.  Na segunda tela, preencha:
    * `Alias`: `SeuNomeSobrenome-key` 
    * `Description`: `Chave para meu aplicativo` 
5.  Clique em `Skip to review` e depois em `Finish`. 

### Cria√ß√£o de Par√¢metros do Tipo `SecureString` (Senhas)

Agora, vamos criar os par√¢metros para as senhas, utilizando a chave KMS que acabamos de criar.

1.  Volte ao servi√ßo **AWS Systems Manager (SSM)** > `Parameter Store`. 
2.  Clique em `Create parameter`. 

    * **Par√¢metro 3 - Ambiente de Desenvolvimento (Senha)**:
        * `Name`: `/meu-app-SeuNomeSobreNome/dev/db-password` 
        * `Description`: `Database password for my app in dev` 
        * `Type`: `SecureString` 
        * `KMS key source`: Mantenha a op√ß√£o padr√£o. 
        * `KMS key id`: Selecione a chave `SeuNomeSobrenome-key` que voc√™ criou. 
        * `Value`: `aqui √© a senha do dev` 
        * Clique em `Create parameter`. 

    * **Par√¢metro 4 - Ambiente de Produ√ß√£o (Senha)**:
        * Repita os passos.
        * `Name`: `/meu-app-SeuNomeSobreNome/prod/db-password` 
        * `Description`: `Database password for my app in prod` 
        * `Type`: `SecureString` 
        * `Value`: `aqui √© a senha da prod` 
        * Clique em `Create parameter`. 

    > ‚úÖ **Verifica√ß√£o**: Ao final desta etapa, voc√™ deve ter 4 par√¢metros no Parameter Store: 2 do tipo `String` e 2 do tipo `SecureString`. 

## Parte 3: Acessando Par√¢metros pela CLI no CloudShell

O CloudShell √© um terminal baseado em navegador que facilita a intera√ß√£o com a AWS CLI.

1.  Acesse o [Console de Gerenciamento da AWS](https://aws.amazon.com/console/) e navegue at√© o servi√ßo **AWS CloudShell**. 
2.  Um terminal ser√° exibido na tela. 

### Recuperando Par√¢metros (com e sem descriptografia)

Vamos utilizar o comando `aws ssm get-parameters` para visualizar nossos par√¢metros.

1.  **Recuperar sem descriptografia:**
    Digite o comando (substitua `SeuNomeSobreNome` pelo seu valor):
    ```bash
    aws ssm get-parameters --names /meu-app-SeuNomeSobreNome/dev/db-url /meu-app-SeuNomeSobreNome/dev/db-password
    ```
    > üí° **Observa√ß√£o**: Voc√™ notar√° que o valor do `SecureString` (`db-password`) estar√° criptografado, enquanto o `String` (`db-url`) estar√° em texto simples. 

2.  **Recuperar com descriptografia:**
    Para descriptografar o valor do `SecureString`, adicione a flag `--with-decryption`:
    ```bash
    aws ssm get-parameters --names /meu-app-SeuNomeSobreNome/dev/db-url /meu-app-SeuNomeSobreNome/dev/db-password --with-decryption
    ```
    > üéâ **Sucesso!**: Agora, ambos os valores (URL e senha) estar√£o em texto simples, demonstrando a funcionalidade do KMS. 

## üóëÔ∏è Limpeza de Recursos

√â crucial excluir os recursos criados para evitar cobran√ßas desnecess√°rias. 

### Excluir Par√¢metros do Parameter Store

1.  Volte ao **AWS Systems Manager (SSM)** > `Parameter Store`. 
2.  Selecione os quatro par√¢metros que voc√™ criou. 
3.  Clique em `Delete` e confirme a exclus√£o. 

### Excluir Chave KMS

1.  Acesse o servi√ßo **AWS Key Management Service (KMS)**. 
2.  Localize a chave com o `Alias` `SeuNomeSobrenome-key` e selecione-a. 
3.  Clique em `Key actions` > `Schedule key deletion`. 
4.  Altere o `Period of wait (in days)` para `7`. 
5.  Marque a caixa de confirma√ß√£o. 
6.  Clique em `Schedule key deletion`. 

---

Parab√©ns por completar este laborat√≥rio! Voc√™ agora tem um entendimento s√≥lido sobre como gerenciar par√¢metros de forma segura na AWS.

Se tiver alguma d√∫vida ou sugest√£o, sinta-se √† vontade para abrir uma *issue* ou enviar um *pull request*.

---